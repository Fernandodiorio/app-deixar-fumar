(globalThis.TURBOPACK || (globalThis.TURBOPACK = [])).push([typeof document === "object" ? document.currentScript : undefined,
"[project]/Desktop/PASTAS/RESPIRAPT/app-deixar-fumar/src/components/ui/theme-provider.tsx [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "ThemeProvider",
    ()=>ThemeProvider
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$Desktop$2f$PASTAS$2f$RESPIRAPT$2f$app$2d$deixar$2d$fumar$2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/Desktop/PASTAS/RESPIRAPT/app-deixar-fumar/node_modules/next/dist/compiled/react/jsx-dev-runtime.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$Desktop$2f$PASTAS$2f$RESPIRAPT$2f$app$2d$deixar$2d$fumar$2f$node_modules$2f$next$2d$themes$2f$dist$2f$index$2e$mjs__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/Desktop/PASTAS/RESPIRAPT/app-deixar-fumar/node_modules/next-themes/dist/index.mjs [app-client] (ecmascript)");
'use client';
;
;
function ThemeProvider(param) {
    let { children, ...props } = param;
    return /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$Desktop$2f$PASTAS$2f$RESPIRAPT$2f$app$2d$deixar$2d$fumar$2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$Desktop$2f$PASTAS$2f$RESPIRAPT$2f$app$2d$deixar$2d$fumar$2f$node_modules$2f$next$2d$themes$2f$dist$2f$index$2e$mjs__$5b$app$2d$client$5d$__$28$ecmascript$29$__["ThemeProvider"], {
        ...props,
        children: children
    }, void 0, false, {
        fileName: "[project]/Desktop/PASTAS/RESPIRAPT/app-deixar-fumar/src/components/ui/theme-provider.tsx",
        lineNumber: 10,
        columnNumber: 10
    }, this);
}
_c = ThemeProvider;
var _c;
__turbopack_context__.k.register(_c, "ThemeProvider");
if (typeof globalThis.$RefreshHelpers$ === 'object' && globalThis.$RefreshHelpers !== null) {
    __turbopack_context__.k.registerExports(__turbopack_context__.m, globalThis.$RefreshHelpers$);
}
}),
"[project]/Desktop/PASTAS/RESPIRAPT/app-deixar-fumar/src/lib/supabase.ts [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "supabase",
    ()=>supabase
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$Desktop$2f$PASTAS$2f$RESPIRAPT$2f$app$2d$deixar$2d$fumar$2f$node_modules$2f$next$2f$dist$2f$build$2f$polyfills$2f$process$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = /*#__PURE__*/ __turbopack_context__.i("[project]/Desktop/PASTAS/RESPIRAPT/app-deixar-fumar/node_modules/next/dist/build/polyfills/process.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$Desktop$2f$PASTAS$2f$RESPIRAPT$2f$app$2d$deixar$2d$fumar$2f$node_modules$2f40$supabase$2f$supabase$2d$js$2f$dist$2f$module$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/Desktop/PASTAS/RESPIRAPT/app-deixar-fumar/node_modules/@supabase/supabase-js/dist/module/index.js [app-client] (ecmascript) <locals>");
;
const supabaseUrl = ("TURBOPACK compile-time value", "https://ggaixybbdvkrbsdhxhlb.supabase.co");
const supabaseAnonKey = ("TURBOPACK compile-time value", "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImdnYWl4eWJiZHZrcmJzZGh4aGxiIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjIyNDIzOTAsImV4cCI6MjA3NzgxODM5MH0.6bOeHvdREPTBYR6VDyw8H_TXXJehdksfDQe9TmwkpZw");
if ("TURBOPACK compile-time falsy", 0) //TURBOPACK unreachable
;
const supabase = (0, __TURBOPACK__imported__module__$5b$project$5d2f$Desktop$2f$PASTAS$2f$RESPIRAPT$2f$app$2d$deixar$2d$fumar$2f$node_modules$2f40$supabase$2f$supabase$2d$js$2f$dist$2f$module$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__["createClient"])(supabaseUrl, supabaseAnonKey);
if (typeof globalThis.$RefreshHelpers$ === 'object' && globalThis.$RefreshHelpers !== null) {
    __turbopack_context__.k.registerExports(__turbopack_context__.m, globalThis.$RefreshHelpers$);
}
}),
"[project]/Desktop/PASTAS/RESPIRAPT/app-deixar-fumar/src/hooks/useAuth.ts [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "useAuth",
    ()=>useAuth
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$Desktop$2f$PASTAS$2f$RESPIRAPT$2f$app$2d$deixar$2d$fumar$2f$node_modules$2f$zustand$2f$esm$2f$react$2e$mjs__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/Desktop/PASTAS/RESPIRAPT/app-deixar-fumar/node_modules/zustand/esm/react.mjs [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$Desktop$2f$PASTAS$2f$RESPIRAPT$2f$app$2d$deixar$2d$fumar$2f$src$2f$lib$2f$supabase$2e$ts__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/Desktop/PASTAS/RESPIRAPT/app-deixar-fumar/src/lib/supabase.ts [app-client] (ecmascript)");
;
;
const useAuth = (0, __TURBOPACK__imported__module__$5b$project$5d2f$Desktop$2f$PASTAS$2f$RESPIRAPT$2f$app$2d$deixar$2d$fumar$2f$node_modules$2f$zustand$2f$esm$2f$react$2e$mjs__$5b$app$2d$client$5d$__$28$ecmascript$29$__["create"])((set, get)=>({
        user: null,
        loading: true,
        initialized: false,
        signIn: async (email, password)=>{
            const { data, error } = await __TURBOPACK__imported__module__$5b$project$5d2f$Desktop$2f$PASTAS$2f$RESPIRAPT$2f$app$2d$deixar$2d$fumar$2f$src$2f$lib$2f$supabase$2e$ts__$5b$app$2d$client$5d$__$28$ecmascript$29$__["supabase"].auth.signInWithPassword({
                email,
                password
            });
            if (error) throw error;
            // Fetch user profile
            let { data: profile } = await __TURBOPACK__imported__module__$5b$project$5d2f$Desktop$2f$PASTAS$2f$RESPIRAPT$2f$app$2d$deixar$2d$fumar$2f$src$2f$lib$2f$supabase$2e$ts__$5b$app$2d$client$5d$__$28$ecmascript$29$__["supabase"].from('users').select('*').eq('id', data.user.id).single();
            // Se o perfil não existe, criar agora
            if (!profile) {
                var _data_user_user_metadata;
                const { data: newProfile, error: createError } = await __TURBOPACK__imported__module__$5b$project$5d2f$Desktop$2f$PASTAS$2f$RESPIRAPT$2f$app$2d$deixar$2d$fumar$2f$src$2f$lib$2f$supabase$2e$ts__$5b$app$2d$client$5d$__$28$ecmascript$29$__["supabase"].from('users').insert({
                    id: data.user.id,
                    email: email,
                    name: ((_data_user_user_metadata = data.user.user_metadata) === null || _data_user_user_metadata === void 0 ? void 0 : _data_user_user_metadata.name) || null,
                    onboarding_completed: false
                }).select().single();
                if (!createError && newProfile) {
                    profile = newProfile;
                }
            }
            set({
                user: profile || null
            });
        },
        signUp: async (email, password, name)=>{
            // Criar usuário no Supabase Auth
            const { data: authData, error: authError } = await __TURBOPACK__imported__module__$5b$project$5d2f$Desktop$2f$PASTAS$2f$RESPIRAPT$2f$app$2d$deixar$2d$fumar$2f$src$2f$lib$2f$supabase$2e$ts__$5b$app$2d$client$5d$__$28$ecmascript$29$__["supabase"].auth.signUp({
                email,
                password,
                options: {
                    data: {
                        name: name || null
                    }
                }
            });
            if (authError) throw authError;
            if (!authData.user) {
                throw new Error('Failed to create user');
            }
            // Aguardar para garantir que a sessão está estabelecida e o trigger executou
            await new Promise((resolve)=>setTimeout(resolve, 1500));
            // Verificar se a sessão está ativa
            const { data: { session } } = await __TURBOPACK__imported__module__$5b$project$5d2f$Desktop$2f$PASTAS$2f$RESPIRAPT$2f$app$2d$deixar$2d$fumar$2f$src$2f$lib$2f$supabase$2e$ts__$5b$app$2d$client$5d$__$28$ecmascript$29$__["supabase"].auth.getSession();
            if (!session) {
                // Se não há sessão, aguardar mais um pouco
                await new Promise((resolve)=>setTimeout(resolve, 1000));
            }
            // Tentar buscar o perfil (trigger deve ter criado)
            let profile = null;
            // Tentar buscar várias vezes com delay crescente
            for(let attempt = 0; attempt < 5; attempt++){
                const { data: fetchedProfile, error: fetchError } = await __TURBOPACK__imported__module__$5b$project$5d2f$Desktop$2f$PASTAS$2f$RESPIRAPT$2f$app$2d$deixar$2d$fumar$2f$src$2f$lib$2f$supabase$2e$ts__$5b$app$2d$client$5d$__$28$ecmascript$29$__["supabase"].from('users').select('*').eq('id', authData.user.id).maybeSingle();
                if (fetchedProfile && !fetchError) {
                    profile = fetchedProfile;
                    break;
                }
                // Se ainda não encontrou, aguardar antes de tentar criar manualmente
                if (attempt < 4) {
                    await new Promise((resolve)=>setTimeout(resolve, 500 * (attempt + 1)));
                }
            }
            // Se ainda não encontrou, tentar criar manualmente
            if (!profile) {
                const { data: newProfile, error: createError } = await __TURBOPACK__imported__module__$5b$project$5d2f$Desktop$2f$PASTAS$2f$RESPIRAPT$2f$app$2d$deixar$2d$fumar$2f$src$2f$lib$2f$supabase$2e$ts__$5b$app$2d$client$5d$__$28$ecmascript$29$__["supabase"].from('users').insert({
                    id: authData.user.id,
                    email: email,
                    name: name || null,
                    onboarding_completed: false
                }).select().single();
                if (createError) {
                    // Se der erro de conflito ou RLS, o trigger deve ter criado
                    // Tentar buscar uma última vez
                    if (createError.code === '23505' || createError.code === '42501') {
                        await new Promise((resolve)=>setTimeout(resolve, 1000));
                        const { data: finalProfile } = await __TURBOPACK__imported__module__$5b$project$5d2f$Desktop$2f$PASTAS$2f$RESPIRAPT$2f$app$2d$deixar$2d$fumar$2f$src$2f$lib$2f$supabase$2e$ts__$5b$app$2d$client$5d$__$28$ecmascript$29$__["supabase"].from('users').select('*').eq('id', authData.user.id).maybeSingle();
                        if (finalProfile) {
                            profile = finalProfile;
                        }
                    }
                    // Se ainda não tem perfil, criar um objeto temporário
                    // O perfil será criado no onboarding ou no primeiro login
                    if (!profile) {
                        profile = {
                            id: authData.user.id,
                            email: email,
                            name: name || null,
                            onboarding_completed: false
                        };
                    }
                } else {
                    profile = newProfile;
                }
            }
            set({
                user: profile
            });
        },
        signOut: async ()=>{
            await __TURBOPACK__imported__module__$5b$project$5d2f$Desktop$2f$PASTAS$2f$RESPIRAPT$2f$app$2d$deixar$2d$fumar$2f$src$2f$lib$2f$supabase$2e$ts__$5b$app$2d$client$5d$__$28$ecmascript$29$__["supabase"].auth.signOut();
            set({
                user: null
            });
        },
        initialize: async ()=>{
            // Prevent multiple initializations
            if (get().initialized) return;
            set({
                initialized: true
            });
            // Check current session first
            const { data: { session } } = await __TURBOPACK__imported__module__$5b$project$5d2f$Desktop$2f$PASTAS$2f$RESPIRAPT$2f$app$2d$deixar$2d$fumar$2f$src$2f$lib$2f$supabase$2e$ts__$5b$app$2d$client$5d$__$28$ecmascript$29$__["supabase"].auth.getSession();
            if (session === null || session === void 0 ? void 0 : session.user) {
                let { data: profile } = await __TURBOPACK__imported__module__$5b$project$5d2f$Desktop$2f$PASTAS$2f$RESPIRAPT$2f$app$2d$deixar$2d$fumar$2f$src$2f$lib$2f$supabase$2e$ts__$5b$app$2d$client$5d$__$28$ecmascript$29$__["supabase"].from('users').select('*').eq('id', session.user.id).maybeSingle();
                // Se o perfil não existe, criar agora
                if (!profile) {
                    var _session_user_user_metadata;
                    const { data: newProfile, error: createError } = await __TURBOPACK__imported__module__$5b$project$5d2f$Desktop$2f$PASTAS$2f$RESPIRAPT$2f$app$2d$deixar$2d$fumar$2f$src$2f$lib$2f$supabase$2e$ts__$5b$app$2d$client$5d$__$28$ecmascript$29$__["supabase"].from('users').insert({
                        id: session.user.id,
                        email: session.user.email || '',
                        name: ((_session_user_user_metadata = session.user.user_metadata) === null || _session_user_user_metadata === void 0 ? void 0 : _session_user_user_metadata.name) || null,
                        onboarding_completed: false
                    }).select().single();
                    if (!createError && newProfile) {
                        profile = newProfile;
                    }
                }
                set({
                    user: profile || null,
                    loading: false
                });
            } else {
                set({
                    user: null,
                    loading: false
                });
            }
            // Listen for auth changes
            __TURBOPACK__imported__module__$5b$project$5d2f$Desktop$2f$PASTAS$2f$RESPIRAPT$2f$app$2d$deixar$2d$fumar$2f$src$2f$lib$2f$supabase$2e$ts__$5b$app$2d$client$5d$__$28$ecmascript$29$__["supabase"].auth.onAuthStateChange(async (event, session)=>{
                if (session === null || session === void 0 ? void 0 : session.user) {
                    let { data: profile } = await __TURBOPACK__imported__module__$5b$project$5d2f$Desktop$2f$PASTAS$2f$RESPIRAPT$2f$app$2d$deixar$2d$fumar$2f$src$2f$lib$2f$supabase$2e$ts__$5b$app$2d$client$5d$__$28$ecmascript$29$__["supabase"].from('users').select('*').eq('id', session.user.id).maybeSingle();
                    // Se o perfil não existe, criar agora
                    if (!profile) {
                        var _session_user_user_metadata;
                        const { data: newProfile, error: createError } = await __TURBOPACK__imported__module__$5b$project$5d2f$Desktop$2f$PASTAS$2f$RESPIRAPT$2f$app$2d$deixar$2d$fumar$2f$src$2f$lib$2f$supabase$2e$ts__$5b$app$2d$client$5d$__$28$ecmascript$29$__["supabase"].from('users').insert({
                            id: session.user.id,
                            email: session.user.email || '',
                            name: ((_session_user_user_metadata = session.user.user_metadata) === null || _session_user_user_metadata === void 0 ? void 0 : _session_user_user_metadata.name) || null,
                            onboarding_completed: false
                        }).select().single();
                        if (!createError && newProfile) {
                            profile = newProfile;
                        }
                    }
                    set({
                        user: profile || null,
                        loading: false
                    });
                } else {
                    set({
                        user: null,
                        loading: false
                    });
                }
            });
        },
        refreshUser: async ()=>{
            const { data: { session } } = await __TURBOPACK__imported__module__$5b$project$5d2f$Desktop$2f$PASTAS$2f$RESPIRAPT$2f$app$2d$deixar$2d$fumar$2f$src$2f$lib$2f$supabase$2e$ts__$5b$app$2d$client$5d$__$28$ecmascript$29$__["supabase"].auth.getSession();
            if (session === null || session === void 0 ? void 0 : session.user) {
                const { data: profile } = await __TURBOPACK__imported__module__$5b$project$5d2f$Desktop$2f$PASTAS$2f$RESPIRAPT$2f$app$2d$deixar$2d$fumar$2f$src$2f$lib$2f$supabase$2e$ts__$5b$app$2d$client$5d$__$28$ecmascript$29$__["supabase"].from('users').select('*').eq('id', session.user.id).maybeSingle();
                if (profile) {
                    set({
                        user: profile
                    });
                }
            }
        }
    }));
if (typeof globalThis.$RefreshHelpers$ === 'object' && globalThis.$RefreshHelpers !== null) {
    __turbopack_context__.k.registerExports(__turbopack_context__.m, globalThis.$RefreshHelpers$);
}
}),
"[project]/Desktop/PASTAS/RESPIRAPT/app-deixar-fumar/src/components/auth-initializer.tsx [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "AuthInitializer",
    ()=>AuthInitializer
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$Desktop$2f$PASTAS$2f$RESPIRAPT$2f$app$2d$deixar$2d$fumar$2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/Desktop/PASTAS/RESPIRAPT/app-deixar-fumar/node_modules/next/dist/compiled/react/index.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$Desktop$2f$PASTAS$2f$RESPIRAPT$2f$app$2d$deixar$2d$fumar$2f$src$2f$hooks$2f$useAuth$2e$ts__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/Desktop/PASTAS/RESPIRAPT/app-deixar-fumar/src/hooks/useAuth.ts [app-client] (ecmascript)");
var _s = __turbopack_context__.k.signature();
'use client';
;
;
function AuthInitializer() {
    _s();
    const { initialize } = (0, __TURBOPACK__imported__module__$5b$project$5d2f$Desktop$2f$PASTAS$2f$RESPIRAPT$2f$app$2d$deixar$2d$fumar$2f$src$2f$hooks$2f$useAuth$2e$ts__$5b$app$2d$client$5d$__$28$ecmascript$29$__["useAuth"])();
    (0, __TURBOPACK__imported__module__$5b$project$5d2f$Desktop$2f$PASTAS$2f$RESPIRAPT$2f$app$2d$deixar$2d$fumar$2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["useEffect"])({
        "AuthInitializer.useEffect": ()=>{
            initialize().catch(console.error);
        }
    }["AuthInitializer.useEffect"], [
        initialize
    ]);
    return null;
}
_s(AuthInitializer, "qNmaX4JurLAvVYhaVyP8wCtVoyM=", false, function() {
    return [
        __TURBOPACK__imported__module__$5b$project$5d2f$Desktop$2f$PASTAS$2f$RESPIRAPT$2f$app$2d$deixar$2d$fumar$2f$src$2f$hooks$2f$useAuth$2e$ts__$5b$app$2d$client$5d$__$28$ecmascript$29$__["useAuth"]
    ];
});
_c = AuthInitializer;
var _c;
__turbopack_context__.k.register(_c, "AuthInitializer");
if (typeof globalThis.$RefreshHelpers$ === 'object' && globalThis.$RefreshHelpers !== null) {
    __turbopack_context__.k.registerExports(__turbopack_context__.m, globalThis.$RefreshHelpers$);
}
}),
]);

//# sourceMappingURL=Desktop_PASTAS_RESPIRAPT_app-deixar-fumar_src_e1fdd801._.js.map