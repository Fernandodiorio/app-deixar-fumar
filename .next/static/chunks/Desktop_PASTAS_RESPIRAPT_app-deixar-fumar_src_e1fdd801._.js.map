{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Fernando%20Monteiro/Desktop/PASTAS/RESPIRAPT/app-deixar-fumar/src/components/ui/theme-provider.tsx"],"sourcesContent":["'use client'\r\n\r\nimport * as React from 'react'\r\nimport {\r\n  ThemeProvider as NextThemesProvider,\r\n  type ThemeProviderProps,\r\n} from 'next-themes'\r\n\r\nexport function ThemeProvider({ children, ...props }: ThemeProviderProps) {\r\n  return <NextThemesProvider {...props}>{children}</NextThemesProvider>\r\n}"],"names":[],"mappings":";;;;;AAGA;AAHA;;;AAQO,SAAS,cAAc,KAA0C;QAA1C,EAAE,QAAQ,EAAE,GAAG,OAA2B,GAA1C;IAC5B,qBAAO,yPAAC,gOAAkB;QAAE,GAAG,KAAK;kBAAG;;;;;;AACzC;KAFgB","debugId":null}},
    {"offset": {"line": 34, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Fernando%20Monteiro/Desktop/PASTAS/RESPIRAPT/app-deixar-fumar/src/lib/supabase.ts"],"sourcesContent":["import { createClient } from '@supabase/supabase-js'\r\n\r\nconst supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL\r\nconst supabaseAnonKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY\r\n\r\nif (!supabaseUrl || !supabaseAnonKey) {\r\n  console.error('Missing Supabase environment variables. Please check your .env.local file.')\r\n  throw new Error('Missing Supabase environment variables')\r\n}\r\n\r\nexport const supabase = createClient(supabaseUrl, supabaseAnonKey)"],"names":[],"mappings":";;;;AAEoB;AAFpB;;AAEA,MAAM;AACN,MAAM;AAEN;;AAKO,MAAM,WAAW,IAAA,sQAAY,EAAC,aAAa","debugId":null}},
    {"offset": {"line": 53, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Fernando%20Monteiro/Desktop/PASTAS/RESPIRAPT/app-deixar-fumar/src/hooks/useAuth.ts"],"sourcesContent":["import { create } from 'zustand';\r\nimport { supabase } from '@/lib/supabase';\r\nimport { User } from '@/types';\r\n\r\ninterface AuthState {\r\n  user: User | null;\r\n  loading: boolean;\r\n  initialized: boolean;\r\n  signIn: (email: string, password: string) => Promise<void>;\r\n  signUp: (email: string, password: string, name?: string) => Promise<void>;\r\n  signOut: () => Promise<void>;\r\n  initialize: () => Promise<void>;\r\n  refreshUser: () => Promise<void>;\r\n}\r\n\r\nexport const useAuth = create<AuthState>((set, get) => ({\r\n  user: null,\r\n  loading: true,\r\n  initialized: false,\r\n\r\n  signIn: async (email: string, password: string) => {\r\n    const { data, error } = await supabase.auth.signInWithPassword({\r\n      email,\r\n      password,\r\n    });\r\n\r\n    if (error) throw error;\r\n\r\n    // Fetch user profile\r\n    let { data: profile } = await supabase\r\n      .from('users')\r\n      .select('*')\r\n      .eq('id', data.user.id)\r\n      .single();\r\n\r\n    // Se o perfil não existe, criar agora\r\n    if (!profile) {\r\n      const { data: newProfile, error: createError } = await supabase\r\n        .from('users')\r\n        .insert({\r\n          id: data.user.id,\r\n          email: email,\r\n          name: data.user.user_metadata?.name || null,\r\n          onboarding_completed: false,\r\n        })\r\n        .select()\r\n        .single();\r\n\r\n      if (!createError && newProfile) {\r\n        profile = newProfile;\r\n      }\r\n    }\r\n\r\n    set({ user: profile || null });\r\n  },\r\n\r\n  signUp: async (email: string, password: string, name?: string) => {\r\n    // Criar usuário no Supabase Auth\r\n    const { data: authData, error: authError } = await supabase.auth.signUp({\r\n      email,\r\n      password,\r\n      options: {\r\n        data: {\r\n          name: name || null,\r\n        },\r\n      },\r\n    });\r\n\r\n    if (authError) throw authError;\r\n\r\n    if (!authData.user) {\r\n      throw new Error('Failed to create user');\r\n    }\r\n\r\n    // Aguardar para garantir que a sessão está estabelecida e o trigger executou\r\n    await new Promise(resolve => setTimeout(resolve, 1500));\r\n\r\n    // Verificar se a sessão está ativa\r\n    const { data: { session } } = await supabase.auth.getSession();\r\n    \r\n    if (!session) {\r\n      // Se não há sessão, aguardar mais um pouco\r\n      await new Promise(resolve => setTimeout(resolve, 1000));\r\n    }\r\n\r\n    // Tentar buscar o perfil (trigger deve ter criado)\r\n    let profile = null;\r\n    \r\n    // Tentar buscar várias vezes com delay crescente\r\n    for (let attempt = 0; attempt < 5; attempt++) {\r\n      const { data: fetchedProfile, error: fetchError } = await supabase\r\n        .from('users')\r\n        .select('*')\r\n        .eq('id', authData.user.id)\r\n        .maybeSingle();\r\n\r\n      if (fetchedProfile && !fetchError) {\r\n        profile = fetchedProfile;\r\n        break;\r\n      }\r\n\r\n      // Se ainda não encontrou, aguardar antes de tentar criar manualmente\r\n      if (attempt < 4) {\r\n        await new Promise(resolve => setTimeout(resolve, 500 * (attempt + 1)));\r\n      }\r\n    }\r\n\r\n    // Se ainda não encontrou, tentar criar manualmente\r\n    if (!profile) {\r\n      const { data: newProfile, error: createError } = await supabase\r\n        .from('users')\r\n        .insert({\r\n          id: authData.user.id,\r\n          email: email,\r\n          name: name || null,\r\n          onboarding_completed: false,\r\n        })\r\n        .select()\r\n        .single();\r\n\r\n      if (createError) {\r\n        // Se der erro de conflito ou RLS, o trigger deve ter criado\r\n        // Tentar buscar uma última vez\r\n        if (createError.code === '23505' || createError.code === '42501') {\r\n          await new Promise(resolve => setTimeout(resolve, 1000));\r\n          const { data: finalProfile } = await supabase\r\n            .from('users')\r\n            .select('*')\r\n            .eq('id', authData.user.id)\r\n            .maybeSingle();\r\n          \r\n          if (finalProfile) {\r\n            profile = finalProfile;\r\n          }\r\n        }\r\n        \r\n        // Se ainda não tem perfil, criar um objeto temporário\r\n        // O perfil será criado no onboarding ou no primeiro login\r\n        if (!profile) {\r\n          profile = {\r\n            id: authData.user.id,\r\n            email: email,\r\n            name: name || null,\r\n            onboarding_completed: false,\r\n          } as User;\r\n        }\r\n      } else {\r\n        profile = newProfile;\r\n      }\r\n    }\r\n\r\n    set({ user: profile });\r\n  },\r\n\r\n  signOut: async () => {\r\n    await supabase.auth.signOut();\r\n    set({ user: null });\r\n  },\r\n\r\n  initialize: async () => {\r\n    // Prevent multiple initializations\r\n    if (get().initialized) return;\r\n\r\n    set({ initialized: true });\r\n\r\n    // Check current session first\r\n    const { data: { session } } = await supabase.auth.getSession();\r\n    \r\n    if (session?.user) {\r\n      let { data: profile } = await supabase\r\n        .from('users')\r\n        .select('*')\r\n        .eq('id', session.user.id)\r\n        .maybeSingle();\r\n\r\n      // Se o perfil não existe, criar agora\r\n      if (!profile) {\r\n        const { data: newProfile, error: createError } = await supabase\r\n          .from('users')\r\n          .insert({\r\n            id: session.user.id,\r\n            email: session.user.email || '',\r\n            name: session.user.user_metadata?.name || null,\r\n            onboarding_completed: false,\r\n          })\r\n          .select()\r\n          .single();\r\n\r\n        if (!createError && newProfile) {\r\n          profile = newProfile;\r\n        }\r\n      }\r\n\r\n      set({ user: profile || null, loading: false });\r\n    } else {\r\n      set({ user: null, loading: false });\r\n    }\r\n\r\n    // Listen for auth changes\r\n    supabase.auth.onAuthStateChange(async (event, session) => {\r\n      if (session?.user) {\r\n        let { data: profile } = await supabase\r\n          .from('users')\r\n          .select('*')\r\n          .eq('id', session.user.id)\r\n          .maybeSingle();\r\n\r\n        // Se o perfil não existe, criar agora\r\n        if (!profile) {\r\n          const { data: newProfile, error: createError } = await supabase\r\n            .from('users')\r\n            .insert({\r\n              id: session.user.id,\r\n              email: session.user.email || '',\r\n              name: session.user.user_metadata?.name || null,\r\n              onboarding_completed: false,\r\n            })\r\n            .select()\r\n            .single();\r\n\r\n          if (!createError && newProfile) {\r\n            profile = newProfile;\r\n          }\r\n        }\r\n\r\n        set({ user: profile || null, loading: false });\r\n      } else {\r\n        set({ user: null, loading: false });\r\n      }\r\n    });\r\n  },\r\n\r\n  refreshUser: async () => {\r\n    const { data: { session } } = await supabase.auth.getSession();\r\n    \r\n    if (session?.user) {\r\n      const { data: profile } = await supabase\r\n        .from('users')\r\n        .select('*')\r\n        .eq('id', session.user.id)\r\n        .maybeSingle();\r\n\r\n      if (profile) {\r\n        set({ user: profile });\r\n      }\r\n    }\r\n  },\r\n}));"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 250, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Fernando%20Monteiro/Desktop/PASTAS/RESPIRAPT/app-deixar-fumar/src/components/auth-initializer.tsx"],"sourcesContent":["'use client'\r\n\r\nimport { useEffect } from 'react'\r\nimport { useAuth } from '@/hooks/useAuth'\r\n\r\nexport function AuthInitializer() {\r\n  const { initialize } = useAuth()\r\n\r\n  useEffect(() => {\r\n    initialize().catch(console.error)\r\n  }, [initialize])\r\n\r\n  return null\r\n}\r\n"],"names":[],"mappings":";;;;AAEA;AACA;;AAHA;;;AAKO,SAAS;;IACd,MAAM,EAAE,UAAU,EAAE,GAAG,IAAA,iMAAO;IAE9B,IAAA,sOAAS;qCAAC;YACR,aAAa,KAAK,CAAC,QAAQ,KAAK;QAClC;oCAAG;QAAC;KAAW;IAEf,OAAO;AACT;GARgB;;QACS,iMAAO;;;KADhB","debugId":null}}]
}